OMERO.server binary repository
==============================

.. topic:: About

    The OMERO.server binary data repository is a fundamental piece of   
    server-side functionality. It provides optimized and indexed storage of
    original file, pixel and thumbnail data, attachments and full text 
    indexes. Its structure is based on :legacy_plone:`OMEIS <ome-server/system-overview/ome-image-server/>`.

Layout
------

The repository is internally laid out as follows:

::

    C:\OMERO
    C:\OMERO\Pixels      <--- Pixel data
    C:\OMERO\Files       <--- Original file data
    C:\OMERO\Thumbnails  <--- Thumbnail data
    C:\OMERO\FullText    <--- Lucene full text search index

Permissions
-----------

Your repository should be owned by the same user that is starting your
OMERO.server instance.

Default Windows user: LocalService
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

By default, the OMERO.server starts as the `LocalService` user. You need to
make sure that that `LocalService` has permissions to see the files under
`C:\\OMERO`.

Configure the Windows user
^^^^^^^^^^^^^^^^^^^^^^^^^^

Alternately, you can configure the OMERO Windows user by setting 
`omero.windows.user` and `omero.windows.pass`::

    C:\omero_dist\> bin\omero config set omero.windows.user USERNAME
    C:\omero_dist\> bin\omero config set omero.windows.pass PASSWORD

.. warning::

    This second method exposes your user password in the OMERO configuration.

.. seealso::

    http://lists.openmicroscopy.org.uk/pipermail/ome-users/2012-November/003442.html

        A thread of the ome-users mailing-list describing the permissions options.


Your repository is not
----------------------

-  The "database"
-  The directory where your OMERO.server binaries are
-  The directory where your OMERO.client (OMERO.insight, OMERO.editor or
   OMERO.importer) binaries are
-  Your PostgreSQL data directory
-  A place to store moldy sandwiches

Changing your repository location
---------------------------------
    
Your repository location can be changed from its ``C:\OMERO`` default by 
modifying your OMERO.server configuration as follows:

Remember that ``C:\`` style paths must have backslashes escaped.

::

    C:\> cd C:\omero_dist
    C:\omero_dist\> bin\omero config set omero.data.dir D:\\OMERO

The suggested procedure is to shut down your OMERO.server instance, move
your repository, change your ``omero.data.dir`` and then start the
instance back up. For example:

::

    C:\> cd C:\omero_dist
    C:\omero_dist\> bin\omero admin stop
    C:\omero_dist\> move C:\OMERO D:\
    C:\omero_dist\> bin\omero config set omero.data.dir D:\\OMERO
    C:\omero_dist\> bin\omero admin start

.. note::

    It is **strongly** recommended that you make all changes to your OMERO 
    binary repository with the server shut down. Changing the 
    ``omero.data.dir`` configuration does **not** move the repository for you, 
    you must do this yourself.